name: sft-qlora-env
channels:
  - conda-forge
  - defaults
dependencies:
  - python=3.11
  - pip
  - pip:
      # Core training stack (CUDA 12.1 wheels)
      - --extra-index-url https://download.pytorch.org/whl/cu121
      - torch>=2.3.0
      - torchvision
      - torchaudio

      # HuggingFace
      - transformers>=4.47.0
      - datasets>=3.0.0
      - tokenizers>=0.20.0
      - huggingface_hub>=0.26.0

      # TRL (SFTTrainer)
      - trl>=0.14.0

      # QLoRA
      - peft>=0.14.0
      - bitsandbytes>=0.45.0

      # Training utilities
      - accelerate>=1.2.0
      - scipy
      - sentencepiece
      - protobuf

      # Flash Attention 2 (optional â€“ comment out if not supported on your GPU)
      # - flash-attn>=2.6.3  --no-build-isolation

      # Logging / tracking
      - mlflow>=2.16.0
      - azureml-mlflow>=1.58.0

      # Evaluation metrics
      - sacrebleu>=2.4.0
      - bert-score>=0.3.13
      - unbabel-comet>=2.2.1

      # Config / misc
      - pyyaml>=6.0
      - tqdm
